//----------------------------------*-C++-*----------------------------------//
// Copyright 2021-2023 UT-Battelle, LLC, and other Celeritas developers.
// See the top-level COPYRIGHT file for details.
// SPDX-License-Identifier: (Apache-2.0 OR MIT)
//---------------------------------------------------------------------------//
//! \file plot_cumulative_z.C
//! \brief Plot showing cumulative z deposition and statistical error.
//---------------------------------------------------------------------------//
#include <TH1D.h>
#include <TCanvas.h>
#include <TLegend.h>
#include <TStyle.h>
#include <TAxis.h>

//---------------------------------------------------------------------------//
/*!
 * Example code for cumulative Z deposition with stat. error.
 *
 * Make sure you have celeritas standard plotting options loaded into ROOT.
 * Instructions in celeritas-docs/utils/rootlogon.C
 *
 * Usage:
 * $ root plot_cumulative_z.C("/path/to/g4_output.root")
 *
 * The G4 data in this plot is extracted using
 * \c g4-validation-app/utils/diagnostics.C .
 */
void plot_cumulative_z()
{
    // >>> Cumulative data
    const double g4_edep_z[1025]
        = {0,           0.000108901, 9.48677e-05, 0.000150753, 0.000116628,
           0.000158618, 0.000111399, 8.70901e-05, 9.94272e-05, 7.34179e-05,
           0.000122321, 8.43576e-05, 7.87262e-05, 0.000149429, 9.58356e-05,
           9.02736e-05, 0.000187933, 0.000185226, 0.000183635, 0.000118221,
           0.000124554, 0.000121324, 0.000157826, 0.000227315, 0.000162251,
           0.000197775, 0.000192599, 0.000192701, 0.000228717, 0.000182028,
           0.00017536,  0.000309268, 0.000240324, 0.000192756, 0.000149576,
           0.000204312, 0.00023389,  0.000186792, 0.000166288, 0.000248667,
           0.00019381,  0.000334037, 0.000207058, 0.000203513, 0.000248266,
           0.000354951, 0.000260524, 0.000332516, 0.000306978, 0.000294496,
           0.000345152, 0.000391597, 0.000338263, 0.00028018,  0.000279367,
           0.000273659, 0.00030457,  0.000221099, 0.000316096, 0.000310348,
           0.000396463, 0.000266657, 0.000353466, 0.000245888, 0.0003446,
           0.000264737, 0.000316154, 0.000273842, 0.000411832, 0.000255305,
           0.00038367,  0.000275009, 0.000280273, 0.000286296, 0.000404654,
           0.000332942, 0.000336619, 0.000458215, 0.000410179, 0.000380274,
           0.000314502, 0.000327788, 0.000319928, 0.000356661, 0.000430146,
           0.000412007, 0.000439388, 0.000385575, 0.00041089,  0.000403774,
           0.000361315, 0.000501242, 0.000422492, 0.000439722, 0.000401849,
           0.00043685,  0.000457475, 0.000347872, 0.00050685,  0.000466767,
           0.000394272, 0.000301799, 0.000460618, 0.000392251, 0.000345077,
           0.00053032,  0.000442969, 0.000391108, 0.000509192, 0.00045076,
           0.000451149, 0.00068192,  0.000590388, 0.000447743, 0.00100849,
           0.00081626,  0.000761795, 0.000599022, 0.000538191, 0.000471682,
           0.000734958, 0.000454023, 0.000515051, 0.000583681, 0.000447957,
           0.000443002, 0.000493981, 0.000528064, 0.000482875, 0.000799798,
           0.00060158,  0.000576949, 0.000523144, 0.000500824, 0.000905329,
           0.00060234,  0.000492708, 0.000703186, 0.000827799, 0.000906334,
           0.000536305, 0.000677395, 0.000538681, 0.000693492, 0.000648059,
           0.000626155, 0.000724687, 0.000543588, 0.000685872, 0.000969934,
           0.000752889, 0.00072982,  0.000754123, 0.000742305, 0.000677499,
           0.000768998, 0.000789817, 0.00112499,  0.000882784, 0.000775257,
           0.000938125, 0.00103225,  0.000751345, 0.0010132,   0.0010268,
           0.000857617, 0.000736444, 0.000758532, 0.000999884, 0.000923097,
           0.000802706, 0.00089247,  0.00102843,  0.000880103, 0.0013137,
           0.00116886,  0.000801512, 0.000907288, 0.000934591, 0.000839221,
           0.0010239,   0.000978117, 0.000784074, 0.000959197, 0.000989125,
           0.000630719, 0.000883685, 0.000827831, 0.000796707, 0.000978196,
           0.000902811, 0.00104576,  0.000953472, 0.000832139, 0.000877672,
           0.00125587,  0.00124224,  0.00144985,  0.00122981,  0.000785931,
           0.000972213, 0.00109394,  0.00117537,  0.00100278,  0.000975064,
           0.00101201,  0.0012146,   0.00157967,  0.00119597,  0.0013776,
           0.0011672,   0.00130621,  0.000955853, 0.00134289,  0.00129948,
           0.00112279,  0.00128796,  0.00129312,  0.00138542,  0.00117377,
           0.00143387,  0.00125645,  0.00159535,  0.00152187,  0.00154619,
           0.00168794,  0.00147237,  0.00148076,  0.00134104,  0.00152829,
           0.00174004,  0.00159801,  0.00173611,  0.00173374,  0.00157446,
           0.00161912,  0.00138285,  0.00350638,  0.0018197,   0.00150786,
           0.00173758,  0.00165089,  0.00156848,  0.00154619,  0.00175712,
           0.00181102,  0.00165354,  0.00193103,  0.00175881,  0.00158079,
           0.00186946,  0.00195635,  0.00146724,  0.00174432,  0.00191313,
           0.0020472,   0.00165213,  0.0037888,   0.00192459,  0.00245034,
           0.00185002,  0.0018142,   0.00158912,  0.00164965,  0.00218562,
           0.00174859,  0.00175427,  0.00197567,  0.00190351,  0.00178251,
           0.00206351,  0.00205246,  0.00228821,  0.00221011,  0.00234459,
           0.00196285,  0.00226064,  0.00192108,  0.0022968,   0.00233674,
           0.00218897,  0.00222,     0.0023152,   0.00230155,  0.00262835,
           0.00229727,  0.00227847,  0.00194249,  0.00248104,  0.00206159,
           0.00243388,  0.00275621,  0.00285542,  0.00243367,  0.00282447,
           0.00284556,  0.00250529,  0.00328682,  0.0033084,   0.00296954,
           0.00314438,  0.00331441,  0.0034685,   0.00338843,  0.00334706,
           0.00297744,  0.00315974,  0.00299613,  0.00324257,  0.00328962,
           0.00390102,  0.00391458,  0.00406207,  0.00340059,  0.00411981,
           0.00453565,  0.00447948,  0.00361841,  0.00465163,  0.00450624,
           0.00404928,  0.00394874,  0.00396608,  0.0045272,   0.0034911,
           0.00383031,  0.00441105,  0.00503768,  0.00393867,  0.00440304,
           0.00440945,  0.00459727,  0.00409843,  0.0041636,   0.00475893,
           0.005445,    0.00558145,  0.00528191,  0.00441238,  0.00691291,
           0.00539237,  0.00542971,  0.0047305,   0.0056195,   0.0057131,
           0.00539798,  0.00563073,  0.0050518,   0.00567206,  0.00638311,
           0.00555265,  0.00553393,  0.0056786,   0.00529763,  0.00515884,
           0.00583823,  0.00559237,  0.00669771,  0.00644878,  0.0068878,
           0.00744275,  0.00772772,  0.0072843,   0.00695532,  0.00717266,
           0.00641128,  0.00734387,  0.0071237,   0.00700586,  0.00688771,
           0.00756632,  0.00722463,  0.00701461,  0.00711942,  0.00797752,
           0.00654384,  0.00709196,  0.00753201,  0.0109187,   0.00767721,
           0.00758589,  0.00736849,  0.00737739,  0.00682858,  0.00830017,
           0.00985123,  0.0093598,   0.0091738,   0.00836913,  0.00989128,
           0.00865968,  0.0112213,   0.00949329,  0.0114855,   0.00923599,
           0.00871832,  0.00938612,  0.00941757,  0.0108106,   0.0101185,
           0.0104125,   0.0100852,   0.00919638,  0.0111096,   0.0105898,
           0.0101409,   0.0108367,   0.00978092,  0.0139527,   0.0125236,
           0.0124963,   0.0128732,   0.0129105,   0.0115726,   0.012684,
           0.0128023,   0.0128268,   0.0122664,   0.0131283,   0.012939,
           0.0149218,   0.0144986,   0.0152181,   0.0144759,   0.0142722,
           0.0166957,   0.0148772,   0.0162074,   0.0154395,   0.0178309,
           0.0191308,   0.0151755,   0.0155923,   0.0188029,   0.0210516,
           0.0176211,   0.0203619,   0.0172291,   0.0175996,   0.0175324,
           0.0184915,   0.0211129,   0.0206268,   0.0192946,   0.0203394,
           0.0212947,   0.0220571,   0.0217558,   0.0206934,   0.0239907,
           0.0228826,   0.0237933,   0.0247538,   0.0219138,   0.0275594,
           0.0229881,   0.0281028,   0.0286073,   0.026417,    0.0255734,
           0.0275022,   0.0289602,   0.0309918,   0.0300964,   0.0275278,
           0.0300749,   0.0333441,   0.0306331,   0.0334091,   0.0339427,
           0.0331369,   0.0371471,   0.0371556,   0.0354194,   0.0332108,
           0.0344272,   0.0389957,   0.0433676,   0.0420413,   0.0403768,
           0.0384836,   0.0477998,   0.0470593,   0.0454174,   0.0476259,
           0.0537565,   0.0513324,   0.0523786,   0.0570076,   0.0576451,
           0.0510243,   0.0570194,   0.0638043,   0.06194,     0.0613642,
           0.0718628,   0.0765402,   0.0736016,   0.080874,    0.0852822,
           0.0850195,   0.0844824,   0.0847321,   0.0874918,   0.096927,
           0.097195,    0.0961084,   0.109449,    0.113505,    0.120772,
           0.129122,    0.12835,     0.152047,    0.16318,     0.175051,
           0.195009,    0.184814,    0.193828,    0.196337,    0.243145,
           0.263858,    0.287988,    0.283662,    0.328506,    0.388334,
           0.418061,    0.438983,    0.483823,    0.569633,    0.634964,
           0.741618,    0.808845,    0.832191,    0.903652,    0.958897,
           0.968522,    1.05747,     1.13876,     1.12623,     1.15582,
           1.1848,      1.26733,     1.26722,     1.3621,      1.26253,
           1.36987,     1.35739,     1.37687,     1.39931,     1.38099,
           1.37983,     1.37246,     1.47677,     1.42691,     1.43751,
           1.40582,     1.42654,     1.48873,     1.50095,     1.43543,
           1.55232,     1.61789,     1.4782,      1.49824,     1.57351,
           1.6713,      1.73211,     1.69564,     1.87868,     1.73761,
           1.81502,     2.02859,     2.17058,     2.13267,     2.70905,
           3.69147,     3.79411,     3.93543,     6.68593,     8.53589,
           8.47484,     8.47135,     8.4473,      8.96077,     9.09038,
           8.36473,     8.21216,     7.36437,     6.62837,     6.47782,
           6.00004,     4.75749,     5.74982,     4.91919,     4.71531,
           4.30567,     3.39964,     3.64226,     2.95993,     2.65017,
           2.75234,     2.44928,     1.73701,     1.75831,     0.977594,
           1.05735,     0.746578,    0.608309,    0.66014,     0.447782,
           0.406781,    0.309174,    0.256399,    0.242916,    0.249713,
           0.242737,    0.197694,    0.180562,    0.280704,    0.15628,
           0.145582,    0.14131,     0.140137,    0.128071,    0.120835,
           0.115599,    0.117548,    0.104526,    0.105019,    0.129477,
           0.139162,    0.108768,    0.104878,    0.101604,    0.106207,
           0.104849,    0.101483,    0.0989454,   0.0963785,   0.0930129,
           0.0907593,   0.0980088,   0.0897179,   0.10566,     0.0760521,
           0.0706565,   0.0824129,   0.0840646,   0.0761271,   0.0796498,
           0.0876312,   0.100821,    0.0859776,   0.110538,    0.0999592,
           0.116241,    0.101432,    0.101816,    0.107106,    0.109203,
           0.160742,    0.15133,     0.0816126,   0.077433,    0.0666226,
           0.0756102,   0.0811706,   0.0655009,   0.090436,    0.0884193,
           0.104782,    0.117047,    0.100636,    0.136795,    0.100552,
           0.0980057,   0.0715308,   0.0826403,   0.0715042,   0.0637335,
           0.0672578,   0.0492708,   0.0551776,   0.0500859,   0.0451835,
           0.0580825,   0.0782717,   0.047631,    0.0528688,   0.0538643,
           0.0645561,   0.0435822,   0.0469887,   0.0365787,   0.0586976,
           0.0427185,   0.0440601,   0.0458454,   0.0320465,   0.0458871,
           0.0285404,   0.0340357,   0.036721,    0.045384,    0.0502476,
           0.0368104,   0.0288188,   0.0292159,   0.0348658,   0.0404082,
           0.0386226,   0.058473,    0.0337358,   0.0309844,   0.0577167,
           0.0348064,   0.0273555,   0.026293,    0.0252135,   0.0282209,
           0.0234522,   0.0229273,   0.020755,    0.0250115,   0.0242715,
           0.0176508,   0.0156325,   0.0123536,   0.01286,     0.0124786,
           0.0112224,   0.011717,    0.0112264,   0.010983,    0.00973017,
           0.0116607,   0.0190415,   0.0132637,   0.010303,    0.0107139,
           0.0111442,   0.00924038,  0.011656,    0.0113667,   0.0168569,
           0.00864566,  0.00857241,  0.0101239,   0.00955904,  0.00812779,
           0.0243036,   0.0124528,   0.00853076,  0.00741142,  0.00687439,
           0.00754301,  0.00718671,  0.00984039,  0.00992088,  0.0117483,
           0.00966312,  0.00759217,  0.00751866,  0.00731744,  0.00697278,
           0.00700565,  0.00649454,  0.00645104,  0.00557116,  0.00592959,
           0.00568149,  0.00612162,  0.00575668,  0.00561665,  0.00557174,
           0.0049588,   0.00565046,  0.00555605,  0.00497755,  0.00546423,
           0.00504806,  0.0052699,   0.00505045,  0.00498107,  0.00540708,
           0.0052135,   0.00507559,  0.00459284,  0.004949,    0.0046886,
           0.00467758,  0.00496813,  0.00484277,  0.00443719,  0.00471776,
           0.00472843,  0.00461874,  0.00418078,  0.00440678,  0.00409587,
           0.00396998,  0.00398263,  0.00370321,  0.00370864,  0.00404817,
           0.00364019,  0.0035119,   0.00367607,  0.00339229,  0.00370546,
           0.00337573,  0.00367194,  0.00319629,  0.00309826,  0.00316546,
           0.00349642,  0.00297996,  0.00303454,  0.00309284,  0.00306238,
           0.00297172,  0.00278762,  0.00323835,  0.00310171,  0.00289902,
           0.00295399,  0.0028203,   0.00280459,  0.00270604,  0.00290396,
           0.00292835,  0.00263911,  0.00237932,  0.00262033,  0.00262727,
           0.00275469,  0.00254012,  0.00245712,  0.00259303,  0.002476,
           0.00237963,  0.00197288,  0.00228705,  0.00221553,  0.00234481,
           0.00245283,  0.00231295,  0.00231276,  0.0023345,   0.00230094,
           0.00201842,  0.00196598,  0.00193494,  0.00208094,  0.00185438,
           0.00215508,  0.00209631,  0.00195851,  0.00178504,  0.00198509,
           0.00186693,  0.00183692,  0.00172368,  0.00190011,  0.00192868,
           0.00173374,  0.00174722,  0.00169676,  0.00193456,  0.00175698,
           0.00172466,  0.00182975,  0.00171059,  0.00197343,  0.00155043,
           0.00153464,  0.0016188,   0.0016656,   0.00154416,  0.00161173,
           0.00162668,  0.00160404,  0.00185456,  0.0013923,   0.00126221,
           0.00169812,  0.00174182,  0.00140843,  0.00146134,  0.00141482,
           0.00135612,  0.00126728,  0.0018081,   0.00148585,  0.00153572,
           0.00136578,  0.0011154,   0.00147158,  0.00107026,  0.00116996,
           0.00158965,  0.00139872,  0.00118273,  0.00102177,  0.00134325,
           0.00138312,  0.00118999,  0.00115279,  0.00129123,  0.00124988,
           0.00121028,  0.00114981,  0.00100936,  0.00100637,  0.000965369,
           0.00130131,  0.0010534,   0.00100423,  0.0010346,   0.00112594,
           0.00106836,  0.0009167,   0.00118102,  0.00104442,  0.000969043,
           0.000967745, 0.00117047,  0.000973607, 0.00100186,  0.00114775,
           0.00108374,  0.00111314,  0.000829632, 0.000827756, 0.000764808,
           0.000930186, 0.000566147, 0.000935571, 0.000641025, 0.000834707,
           0.000883574, 0.000999932, 0.000926324, 0.000841975, 0.000623374,
           0.000742223, 0.000984232, 0.000728193, 0.00078724,  0.000551596,
           0.000670059, 0.000790719, 0.000686834, 0.000738815, 0.000657677,
           0.000845781, 0.000643177, 0.000547909, 0.00070617,  0.000846131,
           0.000626799, 0.000617718, 0.000638896, 0.000646267, 0.0005975,
           0.000736135, 0.000841718, 0.000597531, 0.000526246, 0.000626076,
           0.000708904, 0.000526513, 0.000589581, 0.000547106, 0.000535633,
           0.000566195, 0.00058286,  0.000763752, 0.000711462, 0.000479799,
           0.000599754, 0.00051764,  0.000645506, 0.000535216, 0.000635626,
           0.000501451, 0.000457134, 0.000545133, 0.00048407,  0.000590978,
           0.000492009, 0.000649596, 0.000574095, 0.00047659,  0.000645378,
           0.00042087,  0.000581669, 0.000371461, 0.000347031, 0.000415192,
           0.000325969, 0.000423753, 0.000323527, 0.000415213, 0.00035543,
           0.000370397, 0.000417355, 0.000480906, 0.000315673, 0.000464265,
           0.000331425, 0.000347716, 0.000363029, 0.000373505, 0.000211733,
           0.000259547, 0.000315724, 0.000287102, 0.000321422, 0.000215632,
           0.000176154, 0.00020908,  0.00020958,  0.000223707, 0.000202692};

    const double g4_edep_z_err[1025]
        = {0,           2.05185e-07, 8.01119e-07, 1.31259e-06, 1.19818e-06,
           1.21404e-06, 8.74584e-07, 7.35086e-07, 9.0626e-07,  8.33849e-07,
           1.06393e-06, 5.00128e-07, 8.20747e-07, 1.45723e-06, 8.81712e-07,
           6.71825e-07, 1.81331e-06, 1.78065e-06, 1.68776e-06, 1.19589e-06,
           1.04682e-06, 9.89351e-07, 1.53714e-06, 1.882e-06,   1.50349e-06,
           1.53091e-06, 1.72237e-06, 1.19649e-06, 1.90824e-06, 1.65657e-06,
           1.69732e-06, 2.72942e-06, 2.22765e-06, 1.74963e-06, 1.42803e-06,
           1.98336e-06, 1.97018e-06, 1.52837e-06, 1.61161e-06, 1.75065e-06,
           1.69983e-06, 3.10876e-06, 1.99934e-06, 2.07209e-06, 1.89749e-06,
           2.62493e-06, 1.8226e-06,  2.95741e-06, 2.85109e-06, 2.50898e-06,
           2.51995e-06, 2.93851e-06, 2.80026e-06, 2.10721e-06, 2.0852e-06,
           2.44187e-06, 2.41137e-06, 1.60775e-06, 2.97822e-06, 2.67664e-06,
           3.04923e-06, 2.0289e-06,  2.66861e-06, 1.81913e-06, 3.22602e-06,
           1.74952e-06, 2.26287e-06, 2.18712e-06, 3.30847e-06, 1.89626e-06,
           3.05365e-06, 2.22294e-06, 1.88982e-06, 2.0854e-06,  3.21232e-06,
           2.7472e-06,  2.73686e-06, 3.39177e-06, 3.09968e-06, 3.12328e-06,
           2.44822e-06, 2.26875e-06, 2.24544e-06, 3.08915e-06, 3.09759e-06,
           2.82967e-06, 3.48741e-06, 2.84109e-06, 2.92382e-06, 2.89486e-06,
           2.73854e-06, 3.78289e-06, 3.32725e-06, 3.81362e-06, 3.29519e-06,
           3.64046e-06, 3.35062e-06, 2.43448e-06, 3.9838e-06,  3.21851e-06,
           2.84411e-06, 1.95733e-06, 3.8052e-06,  2.82789e-06, 2.71163e-06,
           3.81975e-06, 3.14484e-06, 2.64157e-06, 3.75059e-06, 3.31818e-06,
           3.64002e-06, 4.70514e-06, 3.87116e-06, 3.29078e-06, 6.40083e-06,
           4.91513e-06, 4.92909e-06, 4.3118e-06,  3.26645e-06, 3.66831e-06,
           4.94173e-06, 3.12321e-06, 3.76668e-06, 3.70079e-06, 3.35423e-06,
           2.92182e-06, 3.31e-06,    3.46371e-06, 3.32565e-06, 4.94328e-06,
           3.99306e-06, 3.82153e-06, 3.64936e-06, 3.44421e-06, 6.13992e-06,
           4.37412e-06, 3.73793e-06, 4.32901e-06, 5.174e-06,   5.44106e-06,
           3.63626e-06, 4.45489e-06, 3.34384e-06, 4.53797e-06, 4.35757e-06,
           4.15579e-06, 4.57037e-06, 3.60291e-06, 4.60501e-06, 6.70513e-06,
           4.77301e-06, 4.93522e-06, 5.23201e-06, 4.93165e-06, 4.4175e-06,
           5.14417e-06, 5.45614e-06, 6.51914e-06, 5.64797e-06, 5.4386e-06,
           5.41938e-06, 6.51037e-06, 5.31572e-06, 6.44933e-06, 6.34133e-06,
           5.65393e-06, 4.86136e-06, 5.01924e-06, 5.72793e-06, 6.14969e-06,
           5.42073e-06, 6.12057e-06, 6.18249e-06, 4.90298e-06, 7.8719e-06,
           7.07208e-06, 5.03653e-06, 5.22994e-06, 5.51056e-06, 5.15357e-06,
           6.53848e-06, 6.33005e-06, 5.07071e-06, 6.1063e-06,  6.43082e-06,
           4.46646e-06, 5.62484e-06, 4.87523e-06, 5.09895e-06, 6.35566e-06,
           5.65338e-06, 6.22014e-06, 6.15401e-06, 4.78672e-06, 5.01644e-06,
           7.89939e-06, 8.45319e-06, 9.09234e-06, 7.62838e-06, 4.86279e-06,
           5.87945e-06, 6.54291e-06, 6.64326e-06, 5.99007e-06, 5.82592e-06,
           5.99272e-06, 7.37556e-06, 9.75559e-06, 6.98083e-06, 8.35381e-06,
           6.35408e-06, 7.76435e-06, 5.69769e-06, 8.24256e-06, 8.07314e-06,
           6.50098e-06, 7.02837e-06, 7.59237e-06, 8.23328e-06, 6.97564e-06,
           8.27855e-06, 7.27362e-06, 9.22585e-06, 9.35529e-06, 8.71253e-06,
           1.10845e-05, 8.50092e-06, 8.93732e-06, 7.95571e-06, 8.88979e-06,
           9.83236e-06, 9.4505e-06,  1.0992e-05,  1.05946e-05, 9.31691e-06,
           9.44245e-06, 8.64655e-06, 2.47136e-05, 1.00548e-05, 9.21538e-06,
           1.08825e-05, 9.32469e-06, 8.73836e-06, 9.00339e-06, 1.09498e-05,
           9.9236e-06,  8.47654e-06, 1.11422e-05, 9.95639e-06, 7.72253e-06,
           1.06657e-05, 1.08636e-05, 8.69201e-06, 9.60391e-06, 1.15923e-05,
           1.09096e-05, 9.55234e-06, 2.86222e-05, 1.06379e-05, 1.4288e-05,
           1.04054e-05, 9.89279e-06, 9.09115e-06, 9.05622e-06, 1.07686e-05,
           8.8684e-06,  1.00763e-05, 1.05529e-05, 1.01969e-05, 9.87531e-06,
           1.14597e-05, 1.14168e-05, 1.2978e-05,  1.21779e-05, 1.28028e-05,
           1.07532e-05, 1.2801e-05,  1.08845e-05, 1.26286e-05, 1.34182e-05,
           1.06231e-05, 1.21443e-05, 1.32186e-05, 1.30144e-05, 1.46852e-05,
           1.28285e-05, 1.33189e-05, 1.01186e-05, 1.32235e-05, 1.08045e-05,
           1.30232e-05, 1.64074e-05, 1.52746e-05, 1.32723e-05, 1.53663e-05,
           1.5464e-05,  1.34747e-05, 1.7787e-05,  1.80016e-05, 1.48399e-05,
           1.65759e-05, 1.77105e-05, 1.87101e-05, 1.7531e-05,  1.76889e-05,
           1.57704e-05, 1.5806e-05,  1.41424e-05, 1.63974e-05, 1.69745e-05,
           1.86085e-05, 1.9191e-05,  2.13547e-05, 1.64865e-05, 2.11656e-05,
           2.22341e-05, 2.52357e-05, 1.82522e-05, 2.43903e-05, 2.13364e-05,
           2.02248e-05, 1.96054e-05, 2.01992e-05, 2.34758e-05, 1.75857e-05,
           1.96203e-05, 2.23773e-05, 2.61298e-05, 1.95982e-05, 2.20905e-05,
           2.35617e-05, 2.25265e-05, 2.07249e-05, 2.05779e-05, 2.52343e-05,
           2.91658e-05, 2.92965e-05, 2.57056e-05, 2.24816e-05, 3.38598e-05,
           2.70428e-05, 2.67845e-05, 2.28399e-05, 2.5964e-05,  2.8929e-05,
           2.68157e-05, 2.76163e-05, 2.49784e-05, 2.61939e-05, 3.11092e-05,
           2.62911e-05, 2.72312e-05, 2.70333e-05, 2.44192e-05, 2.46105e-05,
           2.75963e-05, 2.51473e-05, 3.18067e-05, 3.00917e-05, 3.42003e-05,
           3.49678e-05, 3.70971e-05, 3.25559e-05, 3.1889e-05,  3.12127e-05,
           2.97896e-05, 3.5325e-05,  3.23951e-05, 3.17373e-05, 3.10258e-05,
           3.39284e-05, 3.12996e-05, 3.13542e-05, 3.10111e-05, 3.51387e-05,
           2.89762e-05, 3.2422e-05,  3.27188e-05, 5.58233e-05, 3.39856e-05,
           3.32064e-05, 3.17565e-05, 3.3577e-05,  2.97531e-05, 3.70572e-05,
           4.46894e-05, 4.06752e-05, 4.01085e-05, 3.61868e-05, 4.33071e-05,
           3.92787e-05, 5.07648e-05, 4.03261e-05, 5.22001e-05, 3.93395e-05,
           3.6809e-05,  4.11543e-05, 3.95235e-05, 4.34647e-05, 3.99665e-05,
           4.28384e-05, 4.22175e-05, 3.91934e-05, 4.52655e-05, 4.49605e-05,
           4.11495e-05, 4.46543e-05, 4.00177e-05, 5.93298e-05, 5.17026e-05,
           4.93547e-05, 5.1387e-05,  5.26499e-05, 4.89817e-05, 5.24867e-05,
           5.23911e-05, 5.17086e-05, 5.01671e-05, 5.49472e-05, 5.25625e-05,
           6.19115e-05, 6.01521e-05, 6.4207e-05,  5.75659e-05, 5.67688e-05,
           6.66636e-05, 5.84186e-05, 6.38571e-05, 6.10402e-05, 7.39623e-05,
           6.74121e-05, 5.77403e-05, 6.13603e-05, 7.59015e-05, 8.07504e-05,
           6.77829e-05, 7.2096e-05,  6.78237e-05, 6.60542e-05, 6.84914e-05,
           7.36152e-05, 8.3481e-05,  8.32258e-05, 7.40176e-05, 8.20107e-05,
           7.94528e-05, 8.29188e-05, 8.06257e-05, 7.79423e-05, 8.88751e-05,
           8.50232e-05, 8.7277e-05,  9.33109e-05, 7.76922e-05, 9.72704e-05,
           8.15314e-05, 0.000100133, 0.000102046, 9.75042e-05, 9.20388e-05,
           9.97596e-05, 0.000104905, 0.000103951, 0.000105377, 9.56514e-05,
           0.00010718,  0.000120577, 0.000103391, 0.000116968, 0.000120214,
           0.000117737, 0.000123689, 0.00012543,  0.000118174, 0.000112376,
           0.000119797, 0.000136571, 0.000153641, 0.000149957, 0.000144633,
           0.000134351, 0.000157876, 0.000162307, 0.000154999, 0.000166732,
           0.000183821, 0.000178852, 0.000175733, 0.000198046, 0.000204354,
           0.000181431, 0.000204449, 0.000219296, 0.000206495, 0.000213866,
           0.000236653, 0.000283215, 0.00026286,  0.000277032, 0.000299944,
           0.000287151, 0.000274652, 0.000280232, 0.000283462, 0.000318142,
           0.000318371, 0.000320796, 0.000364762, 0.000371789, 0.000408261,
           0.000440591, 0.000424246, 0.000514544, 0.000560205, 0.000590264,
           0.000631719, 0.000600934, 0.000621308, 0.000654502, 0.000775359,
           0.000873674, 0.000918201, 0.000936824, 0.00106286,  0.00124655,
           0.00135507,  0.00139814,  0.00154578,  0.00186093,  0.00183553,
           0.00235499,  0.00261158,  0.00264759,  0.00285681,  0.0029521,
           0.00304176,  0.00337205,  0.0035796,   0.00348152,  0.00360318,
           0.00374227,  0.00397376,  0.00400746,  0.0041493,   0.00390568,
           0.00432487,  0.00427216,  0.00417816,  0.00421451,  0.0040358,
           0.00425765,  0.00419017,  0.00459889,  0.00434559,  0.00435685,
           0.00424562,  0.00439059,  0.00438582,  0.00437018,  0.00442627,
           0.00475157,  0.00474834,  0.00441429,  0.00459178,  0.00474426,
           0.00518069,  0.00544275,  0.00475289,  0.00575848,  0.00501263,
           0.00540314,  0.00627002,  0.00689119,  0.00627016,  0.00841861,
           0.0115859,   0.0116042,   0.0112921,   0.0204122,   0.0266934,
           0.0256418,   0.025301,    0.0252785,   0.0270342,   0.0274437,
           0.0246435,   0.0250489,   0.0220411,   0.0207504,   0.0196583,
           0.0190455,   0.0140383,   0.0169896,   0.0151353,   0.0146743,
           0.0140271,   0.00998122,  0.0111075,   0.00894033,  0.00789323,
           0.00907037,  0.00748152,  0.00518738,  0.00574607,  0.00297793,
           0.0033033,   0.00219486,  0.00177785,  0.00204485,  0.00146311,
           0.00126274,  0.0010037,   0.000822221, 0.000769745, 0.00081192,
           0.000751551, 0.000606686, 0.000562156, 0.000610091, 0.000486222,
           0.000467036, 0.00045709,  0.000450022, 0.000421165, 0.000395294,
           0.000373784, 0.000394123, 0.000337586, 0.000341296, 0.000451165,
           0.000456364, 0.000347315, 0.00033073,  0.000330306, 0.000334759,
           0.00034533,  0.000342115, 0.000329951, 0.000315999, 0.000313447,
           0.000292199, 0.000341201, 0.000299588, 0.00037335,  0.000249324,
           0.000231905, 0.000257509, 0.000251181, 0.000256077, 0.000257545,
           0.000285845, 0.000341677, 0.00028907,  0.000362123, 0.000318038,
           0.000343017, 0.000326789, 0.000340089, 0.000402456, 0.000376385,
           0.000597163, 0.000556248, 0.000272873, 0.00024895,  0.000239356,
           0.000251324, 0.000279906, 0.000229633, 0.000325852, 0.00029106,
           0.000391541, 0.000434994, 0.000361977, 0.00052854,  0.000402892,
           0.000323984, 0.000264622, 0.000259516, 0.000205744, 0.000207092,
           0.00024487,  0.000196885, 0.000217902, 0.000198157, 0.000161662,
           0.000236019, 0.000280665, 0.000182473, 0.000216897, 0.000201669,
           0.000252588, 0.000172568, 0.000189022, 0.000140061, 0.000246695,
           0.000145434, 0.000160873, 0.000163152, 0.000122513, 0.000172474,
           0.000110082, 0.00015212,  0.00012424,  0.000203141, 0.000173158,
           0.000149809, 0.000109994, 0.000110668, 0.000122937, 0.000184141,
           0.000141721, 0.000229201, 0.000132899, 0.000134139, 0.000243122,
           0.00014304,  0.000106586, 9.87797e-05, 8.81307e-05, 0.000119125,
           9.4526e-05,  9.47986e-05, 8.39692e-05, 0.000108478, 9.38852e-05,
           6.65418e-05, 6.21733e-05, 4.86514e-05, 5.15576e-05, 5.08543e-05,
           4.29272e-05, 4.5992e-05,  4.36209e-05, 4.12105e-05, 3.96028e-05,
           3.94774e-05, 4.86678e-05, 4.72644e-05, 3.97431e-05, 4.3101e-05,
           4.29925e-05, 3.82824e-05, 4.44941e-05, 4.2016e-05,  5.89078e-05,
           3.55834e-05, 3.76e-05,    4.49324e-05, 4.41315e-05, 3.45689e-05,
           0.000145208, 6.1139e-05,  3.787e-05,   3.30158e-05, 2.90514e-05,
           3.17863e-05, 3.06572e-05, 4.55597e-05, 4.48847e-05, 5.24498e-05,
           4.30078e-05, 3.4065e-05,  3.48784e-05, 3.26561e-05, 3.14707e-05,
           3.16455e-05, 2.86832e-05, 2.81764e-05, 2.41975e-05, 2.64339e-05,
           2.53635e-05, 2.7448e-05,  2.4763e-05,  2.51254e-05, 2.39138e-05,
           2.28312e-05, 2.54811e-05, 2.49687e-05, 2.21839e-05, 2.60773e-05,
           2.2876e-05,  2.33543e-05, 2.25444e-05, 2.25622e-05, 2.39738e-05,
           2.27645e-05, 2.40219e-05, 2.07983e-05, 2.26904e-05, 2.10401e-05,
           2.1025e-05,  2.25474e-05, 2.16708e-05, 2.0119e-05,  2.20537e-05,
           2.15963e-05, 2.0924e-05,  1.85052e-05, 1.87596e-05, 1.87674e-05,
           1.77802e-05, 1.91311e-05, 1.72274e-05, 1.8402e-05,  1.85711e-05,
           1.66187e-05, 1.61955e-05, 1.76757e-05, 1.63784e-05, 1.84908e-05,
           1.58166e-05, 1.68337e-05, 1.52924e-05, 1.49869e-05, 1.42552e-05,
           1.64753e-05, 1.38223e-05, 1.40786e-05, 1.52189e-05, 1.49269e-05,
           1.4624e-05,  1.36085e-05, 1.58813e-05, 1.51709e-05, 1.38174e-05,
           1.34884e-05, 1.33837e-05, 1.42231e-05, 1.32259e-05, 1.44938e-05,
           1.46563e-05, 1.29996e-05, 1.26318e-05, 1.20547e-05, 1.34243e-05,
           1.30854e-05, 1.23443e-05, 1.2173e-05,  1.29583e-05, 1.25798e-05,
           1.17258e-05, 9.55681e-06, 1.11399e-05, 1.14437e-05, 1.21082e-05,
           1.20933e-05, 1.20381e-05, 1.16097e-05, 1.23477e-05, 1.16948e-05,
           9.98566e-06, 9.89729e-06, 9.7194e-06,  1.05889e-05, 9.05323e-06,
           1.15299e-05, 1.14698e-05, 1.04158e-05, 9.52223e-06, 1.06389e-05,
           1.05282e-05, 9.48586e-06, 8.88626e-06, 9.86276e-06, 1.03224e-05,
           9.18491e-06, 8.84504e-06, 8.80983e-06, 9.51364e-06, 8.79554e-06,
           9.03715e-06, 1.01488e-05, 9.26731e-06, 1.01041e-05, 8.13526e-06,
           8.27372e-06, 8.30212e-06, 8.29176e-06, 8.23892e-06, 8.70249e-06,
           9.09348e-06, 9.57945e-06, 1.02061e-05, 7.76866e-06, 7.2761e-06,
           9.05133e-06, 9.6084e-06,  7.86021e-06, 7.63358e-06, 7.62657e-06,
           7.75689e-06, 7.0056e-06,  1.04112e-05, 8.24097e-06, 8.192e-06,
           7.86896e-06, 6.18773e-06, 8.25691e-06, 5.83386e-06, 6.3689e-06,
           8.70198e-06, 7.70001e-06, 6.57717e-06, 5.50933e-06, 7.70015e-06,
           7.44815e-06, 6.61048e-06, 6.7813e-06,  7.94001e-06, 6.82559e-06,
           6.81002e-06, 6.36199e-06, 4.98583e-06, 5.18665e-06, 5.15485e-06,
           6.60807e-06, 5.91822e-06, 5.96568e-06, 6.48866e-06, 6.61101e-06,
           6.28401e-06, 5.64487e-06, 6.74018e-06, 6.15723e-06, 6.07059e-06,
           5.40785e-06, 6.6251e-06,  5.91745e-06, 5.85037e-06, 6.72027e-06,
           6.37718e-06, 6.4743e-06,  5.11062e-06, 4.51367e-06, 4.18212e-06,
           4.90284e-06, 3.58213e-06, 5.02476e-06, 3.20587e-06, 5.18831e-06,
           4.89646e-06, 5.88798e-06, 4.82835e-06, 5.03731e-06, 3.69976e-06,
           4.92987e-06, 6.07917e-06, 4.3569e-06,  4.57043e-06, 3.72685e-06,
           4.65228e-06, 5.09672e-06, 4.14782e-06, 4.46427e-06, 4.17878e-06,
           5.37494e-06, 3.76924e-06, 3.51983e-06, 4.09824e-06, 5.59329e-06,
           4.24987e-06, 3.55193e-06, 4.00796e-06, 4.18583e-06, 3.93208e-06,
           4.63231e-06, 5.2637e-06,  3.84675e-06, 3.5224e-06,  4.34905e-06,
           4.57535e-06, 3.26164e-06, 4.40568e-06, 4.44577e-06, 3.42556e-06,
           3.30622e-06, 4.76385e-06, 5.55793e-06, 5.83531e-06, 3.30878e-06,
           3.59929e-06, 3.51333e-06, 4.47698e-06, 4.33113e-06, 4.94543e-06,
           3.71766e-06, 3.23399e-06, 3.99966e-06, 4.24608e-06, 4.44517e-06,
           3.62414e-06, 5.03609e-06, 4.12083e-06, 3.74403e-06, 5.09952e-06,
           2.8532e-06,  4.05259e-06, 2.5267e-06,  2.38226e-06, 3.06541e-06,
           2.07624e-06, 3.29887e-06, 2.37901e-06, 2.94616e-06, 2.67205e-06,
           2.75894e-06, 2.73281e-06, 3.6623e-06,  2.47556e-06, 3.61458e-06,
           2.0821e-06,  2.4552e-06,  2.51102e-06, 2.28169e-06, 1.38819e-06,
           1.63648e-06, 2.40914e-06, 2.21477e-06, 2.34265e-06, 1.42103e-06,
           1.35429e-06, 1.63177e-06, 1.68216e-06, 1.89248e-06, 1.65203e-06};

    // Create histograms for data and statistical errors
    TH1D* h_g4_edep = new TH1D("", "", 1025, -700, 700);
    TH1D* h_g4_err  = new TH1D("", "", 1025, -700, 700);

    // Fill histogram data
    for (int i = 0; i < 1025; i++)
    {
        h_g4_edep->SetBinContent(i, g4_edep_z[i]);
        h_g4_err->SetBinContent(i, 0);

        if (g4_edep_z_err[i] == 0)
        {
            // No error associated to it
            // Manually set to zero to avoid 0/0 = NaN problems
            h_g4_err->SetBinError(i, 0);
        }
        else
        {
            // Error is non-null, calculate the relative error in %
            h_g4_err->SetBinError(i, g4_edep_z_err[i] / g4_edep_z[i] * 100);
        }
    }

    // Create canvas
    auto canvas = new TCanvas("", "", 900, 800);
    canvas->Divide(1, 2);

    // Set X-axis range
    const double x_range = 700;

    // Create top pad
    auto pad_top = new TPad("pad1", "", 0.0, 0.3, 1.0, 1.0);
    pad_top->SetBottomMargin(0.02);
    pad_top->SetLeftMargin(0.12);
    pad_top->Draw();
    pad_top->cd();

    h_g4_edep->GetXaxis()->SetLabelOffset(99);
    h_g4_edep->GetXaxis()->SetNdivisions(510);
    h_g4_edep->GetXaxis()->SetRangeUser(-x_range, x_range);
    h_g4_edep->GetYaxis()->SetTitle("Cumulative energy deposition [MeV]");
    h_g4_edep->GetYaxis()->SetLabelOffset(0.009);
    h_g4_edep->GetYaxis()->CenterTitle();
    h_g4_edep->SetLineColor(kRed + 1);
    h_g4_edep->SetLineWidth(3);

    // Draw histogram and refresh axis
    h_g4_edep->Draw();
    pad_top->RedrawAxis();

    // Create legend
    auto legend = new TLegend(0.66, 0.69, 0.85, 0.86);
    legend->AddEntry(h_g4_edep, "Geant4", "l");
    legend->AddEntry(h_g4_err, "Stat. Err.", "f");
    legend->SetMargin(0.35);
    legend->SetBorderSize(1);
    legend->SetLineColor(kGray);
    legend->Draw();

    // Move back to top canvas
    canvas->cd();

    // Create bottom pad
    auto pad_bottom = new TPad("pad2", "", 0.0, 0.0, 1.0, 0.3);
    pad_bottom->SetTopMargin(0.02);
    pad_bottom->SetBottomMargin(0.4);
    pad_bottom->SetLeftMargin(0.12);
    pad_bottom->Draw();
    pad_bottom->cd();

    // Relative error plot attributes
    h_g4_err->GetXaxis()->SetTitle("z [cm]");
    h_g4_err->GetXaxis()->CenterTitle();
    h_g4_err->GetXaxis()->SetTitleSize(0.15);
    h_g4_err->GetXaxis()->SetTitleOffset(1.2);
    h_g4_err->GetXaxis()->SetLabelSize(0.1155);
    h_g4_err->GetXaxis()->SetLabelOffset(0.04);
    h_g4_err->GetXaxis()->SetNdivisions(510);
    h_g4_err->GetXaxis()->SetRangeUser(-x_range, x_range);

    h_g4_err->GetYaxis()->SetTitle("Rel Err (%)");
    h_g4_err->GetYaxis()->CenterTitle();
    h_g4_err->GetYaxis()->SetTitleSize(0.131);
    h_g4_err->GetYaxis()->SetTitleOffset(0.415);
    h_g4_err->GetYaxis()->SetLabelSize(0.116);
    h_g4_err->GetYaxis()->SetLabelOffset(0.008);
    h_g4_err->GetYaxis()->SetTickLength(0.04);
    h_g4_err->GetYaxis()->SetNdivisions(503);

    h_g4_err->SetLineColorAlpha(kGray + 2, 0.7);
    h_g4_err->SetFillColorAlpha(kGray + 2, 0.7);
    h_g4_err->SetMarkerSize(0);

    // Draw histogram and refresh axis
    h_g4_err->Draw("hist E2");
    pad_bottom->RedrawAxis();
}
